<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù„ÛŒØªØ§</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 30px;
            margin: 20px auto;
            max-width: 1000px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            font-size: 2.5rem;
        }
        
        .tabs { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab { 
            padding: 12px 24px; 
            background: rgba(255,255,255,0.2); 
            border-radius: 10px; 
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            border: none;
            font-size: 16px;
        }
        
        .tab:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .tab.active { 
            background: rgba(255,255,255,0.4);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr;
            gap: 20px; 
            margin-top: 20px; 
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        
        input, select, textarea {
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.9);
            font-size: 16px;
            width: 100%;
        }
        
        .btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s;
            font-size: 16px;
            grid-column: 1 / -1;
        }
        
        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
        }
        
        .data-table {
            width: 100%;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
            border-collapse: collapse;
        }
        
        .data-table th, .data-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #eee;
        }
        
        .data-table th {
            background: rgba(102, 126, 234, 0.8);
            color: white;
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }
        
        .action-btn {
            padding: 6px 12px;
            margin: 0 2px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-btn { background: #4ECDC4; color: white; }
        .delete-btn { background: #FF6B6B; color: white; }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }
        
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        
        .permission-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4ECDC4;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body>
    <div class="glass-panel">
        <h1>ğŸ›ï¸ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù„ÛŒØªØ§</h1>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('students')">ğŸ‘¥ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù†</button>
            <button class="tab" onclick="showTab('classes')">ğŸ“š Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§</button>
            <button class="tab" onclick="showTab('permissions')">âš™ï¸ Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§</button>
            <button class="tab" onclick="showTab('send')">ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ù†Ø§Ù…Ù‡</button>
        </div>
        
        <!-- ØªØ¨ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù† -->
        <div id="students-tab" class="tab-content active">
            <h3>ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù†</h3>
            <div class="form-grid">
                <input type="text" id="firstName" placeholder="Ù†Ø§Ù… Ø¯Ø§Ù†Ø´Ø¬Ùˆ">
                <input type="text" id="lastName" placeholder="Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
                <input type="text" id="studentCode" placeholder="Ú©Ø¯ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ">
                <input type="text" id="nationalCode" placeholder="Ú©Ø¯ Ù…Ù„ÛŒ">
                <button class="btn" onclick="addStudent()">â• Ø§ÙØ²ÙˆØ¯Ù† Ø¯Ø§Ù†Ø´Ø¬Ùˆ</button>
            </div>
            
            <div id="students-status" class="status" style="display: none;"></div>
            <div id="students-list" style="margin-top: 20px;"></div>
        </div>
        
        <!-- ØªØ¨ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ -->
        <div id="classes-tab" class="tab-content">
            <h3>ğŸ“š Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§</h3>
            <div class="form-grid">
                <input type="text" id="className" placeholder="Ù†Ø§Ù… Ú©Ù„Ø§Ø³">
                <input type="text" id="instructor" placeholder="Ù†Ø§Ù… Ø§Ø³ØªØ§Ø¯">
                <select id="classDay">
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ²</option>
                    <option value="Ø´Ù†Ø¨Ù‡">Ø´Ù†Ø¨Ù‡</option>
                    <option value="ÛŒÚ©Ø´Ù†Ø¨Ù‡">ÛŒÚ©Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ø¯ÙˆØ´Ù†Ø¨Ù‡">Ø¯ÙˆØ´Ù†Ø¨Ù‡</option>
                    <option value="Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡">Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡</option>
                    <option value="Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡">Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡">Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ø¬Ù…Ø¹Ù‡">Ø¬Ù…Ø¹Ù‡</option>
                </select>
                <input type="text" id="classTime" placeholder="Ø²Ù…Ø§Ù† (Ù…Ø«Ø§Ù„: 10:00-12:00)">
                <button class="btn" onclick="addClass()">â• Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù„Ø§Ø³</button>
            </div>
            
            <div id="classes-status" class="status" style="display: none;"></div>
            <div id="classes-list" style="margin-top: 20px;"></div>
        </div>
        
        <!-- ØªØ¨ Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ -->
        <div id="permissions-tab" class="tab-content">
            <h3>âš™ï¸ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§</h3>
            <div class="permission-toggle">
                <label>Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ:</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="permission-summary" onchange="updatePermission('summary', this.checked)">
                    <span class="slider"></span>
                </label>
                <span id="summary-status">ÙØ¹Ø§Ù„</span>
            </div>
            
            <div class="permission-toggle">
                <label>ØªØ±Ø¬Ù…Ù‡:</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="permission-translate" onchange="updatePermission('translate', this.checked)">
                    <span class="slider"></span>
                </label>
                <span id="translate-status">ÙØ¹Ø§Ù„</span>
            </div>
            
            <div class="permission-toggle">
                <label>Ù¾Ø±Ø³Ø´ Ùˆ Ù¾Ø§Ø³Ø®:</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="permission-qa" onchange="updatePermission('qa', this.checked)">
                    <span class="slider"></span>
                </label>
                <span id="qa-status">ÙØ¹Ø§Ù„</span>
            </div>
            
            <div id="permissions-status" class="status" style="display: none;"></div>
        </div>
        
        <!-- ØªØ¨ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ù†Ø§Ù…Ù‡ -->
        <div id="send-tab" class="tab-content">
            <h3>ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ú©Ù„Ø§Ø³ÛŒ</h3>
            <div class="form-grid">
                <select id="sendDay">
                    <option value="today">Ø§Ù…Ø±ÙˆØ²</option>
                    <option value="Ø´Ù†Ø¨Ù‡">Ø´Ù†Ø¨Ù‡</option>
                    <option value="ÛŒÚ©Ø´Ù†Ø¨Ù‡">ÛŒÚ©Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ø¯ÙˆØ´Ù†Ø¨Ù‡">Ø¯ÙˆØ´Ù†Ø¨Ù‡</option>
                    <option value="Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡">Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡</option>
                    <option value="Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡">Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡">Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡</option>
                    <option value="Ø¬Ù…Ø¹Ù‡">Ø¬Ù…Ø¹Ù‡</option>
                </select>
                <input type="text" id="chatId" placeholder="Ø¢ÛŒØ¯ÛŒ Ú†Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
                <button class="btn" onclick="sendSchedule()">ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ù†Ø§Ù…Ù‡</button>
            </div>
            
            <div id="send-status" class="status" style="display: none;"></div>
            <div id="schedule-preview" style="margin-top: 20px;"></div>
        </div>
    </div>

    <script>
        const API_URL = '/api/admin';
        let PASSWORD = null;
        let currentData = null;

        // Ø§Ø¨ØªØ¯Ø§ Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ø¨Ú¯ÛŒØ±
        function getPassword() {
            if (!PASSWORD) {
                PASSWORD = prompt('Ù„Ø·ÙØ§Ù‹ Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
                if (!PASSWORD) {
                    alert('Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù¾Ù†Ù„ Ø¨Ø§ÛŒØ¯ Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                    return false;
                }
            }
            return true;
        }

        // Ù†Ù…Ø§ÛŒØ´ ØªØ¨â€ŒÙ‡Ø§
        function showTab(tabName) {
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªØ¨â€ŒÙ‡Ø§
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Ù†Ù…Ø§ÛŒØ´ ØªØ¨ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            const activeTab = document.getElementById(tabName + '-tab');
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ù…Ø±Ø¨ÙˆØ·Ù‡
            const activeButton = Array.from(document.querySelectorAll('.tab')).find(btn => 
                btn.onclick && btn.onclick.toString().includes(tabName)
            );
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ¨
            if (tabName === 'students') {
                loadStudents();
            } else if (tabName === 'classes') {
                loadClasses();
            } else if (tabName === 'permissions') {
                loadPermissions();
            } else if (tabName === 'send') {
                loadSchedulePreview();
            }
        }

        // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ API
       // Ø¯Ø± public/admin-panel.html - Ø¨Ø®Ø´ apiCall Ø±Ùˆ Ø§ÛŒÙ†Ø·ÙˆØ± Ø§ØµÙ„Ø§Ø­ Ú©Ù†:
async function apiCall(action, data = {}) {
    if (!PASSWORD) {
        PASSWORD = prompt('Ù„Ø·ÙØ§Ù‹ Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
        if (!PASSWORD) return null;
    }

    try {
        const response = await fetch(API_URL, {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({ 
                action, 
                data, 
                password: PASSWORD 
            })
        });

        const result = await response.json();
        
        if (!response.ok) {
            // Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
            let errorMessage = `Ø®Ø·Ø§ÛŒ Ø³Ø±ÙˆØ±: ${response.status}`;
            
            if (result && result.error) {
                errorMessage = result.error;
                if (result.message) {
                    errorMessage += ` - ${result.message}`;
                }
            }
            
            throw new Error(errorMessage);
        }
        
        return result;
        
    } catch (error) {
        console.error('API Error:', error);
        
        // Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
        let userMessage = error.message;
        if (error.message.includes('401')) {
            userMessage = 'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª! Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.';
            PASSWORD = null; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø±Ù…Ø² Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…Ø¬Ø¯Ø¯
        } else if (error.message.includes('400')) {
            userMessage = 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.';
        } else if (error.message.includes('500')) {
            userMessage = 'Ø®Ø·Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ç¨åå†è¯•.';
        }
        
        showStatus('error', userMessage, 'global');
        return null;
    }
}

        // Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª
        function showStatus(type, message, tab = 'global') {
            const statusElement = document.getElementById(tab + '-status') || 
                                document.querySelector('.status');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.className = `status ${type}`;
                statusElement.style.display = 'block';
                
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 5000);
            }
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù†
        async function addStudent() {
            const student = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                studentCode: document.getElementById('studentCode').value,
                nationalCode: document.getElementById('nationalCode').value
            };
            
            if (!student.firstName || !student.lastName) {
                showStatus('error', 'Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø§Ø³Øª', 'students');
                return;
            }

            const result = await apiCall('addStudent', student);
            if (result && result.success) {
                showStatus('success', 'Ø¯Ø§Ù†Ø´Ø¬Ùˆ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'students');
                clearStudentForm();
                loadStudents();
            }
        }

        async function loadStudents() {
            const result = await apiCall('getData');
            if (result && result.data) {
                currentData = result.data;
                displayStudents(result.data.students || []);
            }
        }

        function displayStudents(students) {
            const container = document.getElementById('students-list');
            if (students.length === 0) {
                container.innerHTML = '<p>Ù‡Ù†ÙˆØ² Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p>';
                return;
            }

            container.innerHTML = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Ù†Ø§Ù…</th>
                            <th>Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</th>
                            <th>Ú©Ø¯ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ</th>
                            <th>Ú©Ø¯ Ù…Ù„ÛŒ</th>
                            <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${students.map(student => `
                            <tr>
                                <td>${student.firstName || ''}</td>
                                <td>${student.lastName || ''}</td>
                                <td>${student.studentCode || ''}</td>
                                <td>${student.nationalCode || ''}</td>
                                <td>
                                    <button class="action-btn edit-btn" onclick="editStudent(${student.id})">âœï¸</button>
                                    <button class="action-btn delete-btn" onclick="deleteStudent(${student.id})">ğŸ—‘ï¸</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function clearStudentForm() {
            document.getElementById('firstName').value = '';
            document.getElementById('lastName').value = '';
            document.getElementById('studentCode').value = '';
            document.getElementById('nationalCode').value = '';
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ (Ù…Ø´Ø§Ø¨Ù‡ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù†)
        async function addClass() {
            const classData = {
                className: document.getElementById('className').value,
                instructor: document.getElementById('instructor').value,
                day: document.getElementById('classDay').value,
                time: document.getElementById('classTime').value
            };
            
            if (!classData.className || !classData.day) {
                showStatus('error', 'Ù†Ø§Ù… Ú©Ù„Ø§Ø³ Ùˆ Ø±ÙˆØ² Ø¶Ø±ÙˆØ±ÛŒ Ø§Ø³Øª', 'classes');
                return;
            }

            const result = await apiCall('addClass', classData);
            if (result && result.success) {
                showStatus('success', 'Ú©Ù„Ø§Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'classes');
                clearClassForm();
                loadClasses();
            }
        }

        async function loadClasses() {
            const result = await apiCall('getData');
            if (result && result.data) {
                displayClasses(result.data.classes || []);
            }
        }

        function displayClasses(classes) {
            const container = document.getElementById('classes-list');
            if (classes.length === 0) {
                container.innerHTML = '<p>Ù‡Ù†ÙˆØ² Ú©Ù„Ø§Ø³ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p>';
                return;
            }

            container.innerHTML = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Ù†Ø§Ù… Ú©Ù„Ø§Ø³</th>
                            <th>Ø§Ø³ØªØ§Ø¯</th>
                            <th>Ø±ÙˆØ²</th>
                            <th>Ø²Ù…Ø§Ù†</th>
                            <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${classes.map(classItem => `
                            <tr>
                                <td>${classItem.className || ''}</td>
                                <td>${classItem.instructor || ''}</td>
                                <td>${classItem.day || ''}</td>
                                <td>${classItem.time || ''}</td>
                                <td>
                                    <button class="action-btn edit-btn">âœï¸</button>
                                    <button class="action-btn delete-btn">ğŸ—‘ï¸</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function clearClassForm() {
            document.getElementById('className').value = '';
            document.getElementById('instructor').value = '';
            document.getElementById('classDay').value = '';
            document.getElementById('classTime').value = '';
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§
        async function loadPermissions() {
            const result = await apiCall('getData');
            if (result && result.data && result.data.settings) {
                const perms = result.data.settings.permissions || {};
                document.getElementById('permission-summary').checked = perms.summary !== false;
                document.getElementById('permission-translate').checked = perms.translate !== false;
                document.getElementById('permission-qa').checked = perms.qa !== false;
            }
        }

        async function updatePermission(permission, value) {
            const result = await apiCall('updatePermissions', { [permission]: value });
            if (result && result.success) {
                showStatus('success', `Ø¯Ø³ØªØ±Ø³ÛŒ ${permission} ${value ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ±ÙØ¹Ø§Ù„'} Ø´Ø¯`, 'permissions');
            }
        }

        // Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø±Ù†Ø§Ù…Ù‡
        async function loadSchedulePreview() {
            const result = await apiCall('getData');
            if (result && result.data) {
                displaySchedulePreview(result.data.classes || []);
            }
        }

        function displaySchedulePreview(classes) {
            const container = document.getElementById('schedule-preview');
            if (classes.length === 0) {
                container.innerHTML = '<p>Ù‡Ù†ÙˆØ² Ú©Ù„Ø§Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
                return;
            }

            container.innerHTML = `
                <h4>Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø±Ù†Ø§Ù…Ù‡:</h4>
                <div style="background: rgba(255,255,255,0.9); padding: 15px; border-radius: 10px;">
                    ${classes.map(c => `<p>â€¢ ${c.className} - ${c.day} ${c.time} - ${c.instructor}</p>`).join('')}
                </div>
            `;
        }

        async function sendSchedule() {
            const day = document.getElementById('sendDay').value;
            const chatId = document.getElementById('chatId').value;
            
            showStatus('info', 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...', 'send');
            // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ API Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø±Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒ
        }

        // ØªÙˆØ§Ø¨Ø¹ ÙˆÛŒØ±Ø§ÛŒØ´ Ùˆ Ø­Ø°Ù (Ø³Ø§Ø¯Ù‡ Ø´Ø¯Ù‡)
        function editStudent(id) {
            alert(`ÙˆÛŒØ±Ø§ÛŒØ´ Ø¯Ø§Ù†Ø´Ø¬Ùˆ Ø¨Ø§ ID: ${id} - Ø§ÛŒÙ† Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯Ø± Ù†Ø³Ø®Ù‡ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯`);
        }

        function deleteStudent(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø¯Ø§Ù†Ø´Ø¬Ùˆ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                apiCall('deleteStudent', { id });
                loadStudents();
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            showTab('students');
        });
    </script>
</body>
</html>